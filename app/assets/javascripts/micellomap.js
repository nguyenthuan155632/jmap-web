var micello={};micello.maps={},micello.maps.PROTOCOL="http","https:"==location.protocol&&(micello.maps.PROTOCOL="https"),micello.maps.VERSION_SERVER="maps.micello.com",micello.maps.init=function(t,e){micello.maps.key=t,micello.maps.initCallback=e,micello.maps.MapControl&&e()},micello.maps.loadInit=function(){var t=((new Date).getTime(),document.createElement("canvas")),e=(t.getContext?1:0,micello.maps.PROTOCOL+"://"+location.hostname+"/javascripts/micellomap.json");micello.maps.networkRequest(e,micello.maps.loadInit2,micello.maps.errorHandler,"POST")},micello.maps.loadInit2=function(t){var e=document.getElementsByTagName("head")[0];if(!e)return void micello.maps.onMapError("Error: head element not found!");var o,l=t.scripts;if(l)for(o=0;o<l.length;o++)micello.maps.addScript(e,l[o]);var a=t.css;if(a)for(o=0;o<a.length;o++)micello.maps.addCss(e,a[o])},micello.maps.addScript=function(t,e){"http"==e.substr(0,4)?(srcTmp=e.split(":"),e=micello.maps.PROTOCOL+":"+srcTmp[1]):e=micello.maps.PROTOCOL+"://"+e;var o=document.createElement("script");o.type="text/javascript",o.src=e,t.appendChild(o)},micello.maps.addCss=function(t,e){"http"==e.substr(0,4)?(srcTmp=e.split(":"),e=micello.maps.PROTOCOL+":"+srcTmp[1]):e=micello.maps.PROTOCOL+"://"+e;var o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href=e,t.appendChild(o)},micello.maps.networkRequest=function(url,onDownload,onFailure,httpMethod,body){var xmlhttp,doIe=!1;if(window.XDomainRequest)xmlhttp=new XDomainRequest,xmlhttp.timeout=1e4,doIe=!0;else{if(!window.XMLHttpRequest)return void onFailure("This browser is not supported.");xmlhttp=new XMLHttpRequest}doIe?(xmlhttp.onload=function(){var data=eval("("+xmlhttp.responseText+")");data.error?(msg="Error in request: "+data.error,onFailure(msg)):onDownload(data)},xmlhttp.onerror=function(){msg="Error in http request. Status: "+xmlhttp.status,onFailure(msg)},xmlhttp.ontimeout=function(){},xmlhttp.onprogress=function(){}):(xmlhttp.dataManager=this,xmlhttp.onreadystatechange=function(){var msg;if(4==xmlhttp.readyState&&200==xmlhttp.status){var data=eval("("+xmlhttp.responseText+")");data.error?(msg="Error in request: "+data.error,onFailure(msg)):onDownload(data)}else 4==xmlhttp.readyState&&xmlhttp.status>=400&&(msg="Error in http request. Status: "+xmlhttp.status,onFailure(msg))}),xmlhttp.open(httpMethod,url,!0),doIe||"POST"==httpMethod&&xmlhttp.setRequestHeader("Content-Type","text/plain"),doIe?setTimeout(function(){xmlhttp.send(body)},0):xmlhttp.send(body)},micello.maps.errorHandler=function(t){e=document.createElement("div"),e.innerHTML="Micello Map: "+t,e.setAttribute("id","micello-map-msg"),e.style.top=0,e.style.left=0,e.style.padding="7px",e.style.border="1px solid #666",e.style.backgroundColor="#fff",e.style.position="absolute",document.body.appendChild(e),setTimeout(function(t){eM=document.getElementById("micello-map-msg"),eM.style.display="none"},7e3)},micello.maps.onMapError=micello.maps.errorHandler,micello.maps.loadInit();